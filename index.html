<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milestone Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Dynamic Glow Effects */
        .glow-nba { text-shadow: 0 0 15px rgba(249, 115, 22, 0.6); }
        .glow-nhl { text-shadow: 0 0 15px rgba(59, 130, 246, 0.6); }
        
        /* Smooth transition for theme changes */
        body, .theme-text, .theme-border, .theme-bg {
            transition: all 0.3s ease;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }
    </style>
</head>
<body class="bg-gray-950 text-gray-100 min-h-screen font-sans">

    <div class="container mx-auto px-4 py-8">
        
        <!-- HEADER & TOGGLE -->
        <header class="text-center mb-8">
            <!-- League Toggles -->
            <div class="flex justify-center gap-4 mb-6">
                <button onclick="switchLeague('nba')" id="btn-nba" class="px-6 py-2 rounded-full font-bold text-lg border-2 border-gray-700 hover:border-orange-500 hover:text-orange-500 transition-all">
                    üèÄ NBA
                </button>
                <button onclick="switchLeague('nhl')" id="btn-nhl" class="px-6 py-2 rounded-full font-bold text-lg border-2 border-gray-700 hover:border-blue-500 hover:text-blue-500 transition-all">
                    üèí NHL
                </button>
            </div>

            <!-- Dynamic Title -->
            <h1 id="main-title" class="text-5xl md:text-7xl font-bold mb-2 tracking-tighter uppercase transition-all duration-300">
                MILESTONE WATCH
            </h1>
            <p id="sub-title" class="text-gray-400 text-lg">Select a league to view approaching milestones</p>
            <p id="status-message" class="text-sm text-gray-600 mt-2">Ready</p>
        </header>

        <!-- DATA TABLE -->
        <div class="max-w-5xl mx-auto bg-gray-900 rounded-xl shadow-2xl overflow-hidden border border-gray-800">
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-gray-800 text-gray-400 uppercase text-xs tracking-wider">
                        <tr>
                            <th class="p-5">Player</th>
                            <th class="p-5">Team</th>
                            <th class="p-5 text-center" id="col-current">Current</th>
                            <th class="p-5 text-center">Target</th>
                            <th class="p-5 text-center font-bold" id="header-needs">Needs</th>
                        </tr>
                    </thead>
                    <tbody id="stats-body" class="divide-y divide-gray-800">
                        <!-- Rows inserted by JS -->
                    </tbody>
                </table>
            </div>
            
            <!-- Loading / Empty States -->
            <div id="loading" class="hidden p-12 text-center text-gray-500">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gray-400 mb-2"></div>
                <p>Scouting the league...</p>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const DATA_FILES = {
            nba: 'nba_milestones.json',
            nhl: 'nhl_milestones.json'
        };

        const THEMES = {
            nba: {
                title: "HOOP TRACKER",
                color: "text-orange-500",
                glow: "glow-nba",
                statName: "Points",
                needsColor: "text-orange-400"
            },
            nhl: {
                title: "PUCK TRACKER",
                color: "text-blue-500",
                glow: "glow-nhl",
                statName: "Goals",
                needsColor: "text-blue-400"
            }
        };

        // Demo Data for Fallback
        const MOCK_DATA = {
            nba: [
                { player_name: "Demo: LeBron James", team: "LAL", current_stat: 39950, target_milestone: 40000, needed: 50 },
                { player_name: "Demo: Curry", team: "GSW", current_stat: 23990, target_milestone: 24000, needed: 10 }
            ],
            nhl: [
                { player_name: "Demo: Ovechkin", team: "WSH", current_stat: 851, target_milestone: 894, needed: 43 },
                { player_name: "Demo: Crosby", team: "PIT", current_stat: 590, target_milestone: 600, needed: 10 }
            ]
        };

        let currentLeague = 'nba';

        // --- FUNCTIONS ---

        async function switchLeague(league) {
            currentLeague = league;
            updateTheme(league);
            await loadData(league);
        }

        function updateTheme(league) {
            const theme = THEMES[league];
            const title = document.getElementById('main-title');
            const sub = document.getElementById('sub-title');
            const btnNBA = document.getElementById('btn-nba');
            const btnNHL = document.getElementById('btn-nhl');
            const needsHeader = document.getElementById('header-needs');
            const currentHeader = document.getElementById('col-current');

            // Reset Buttons
            btnNBA.className = `px-6 py-2 rounded-full font-bold text-lg border-2 border-gray-700 text-gray-500 hover:border-orange-500 hover:text-orange-500 transition-all`;
            btnNHL.className = `px-6 py-2 rounded-full font-bold text-lg border-2 border-gray-700 text-gray-500 hover:border-blue-500 hover:text-blue-500 transition-all`;

            // Activate Selected Button
            if (league === 'nba') {
                btnNBA.className = `px-6 py-2 rounded-full font-bold text-lg border-2 border-orange-500 text-orange-500 shadow-[0_0_15px_rgba(249,115,22,0.4)] transition-all`;
            } else {
                btnNHL.className = `px-6 py-2 rounded-full font-bold text-lg border-2 border-blue-500 text-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.4)] transition-all`;
            }

            // Update Text & Colors
            title.innerText = theme.title;
            title.className = `text-5xl md:text-7xl font-bold mb-2 tracking-tighter uppercase transition-all duration-300 ${theme.color} ${theme.glow}`;
            
            sub.innerText = `Tracking approaching ${theme.statName} milestones`;
            currentHeader.innerText = `Current ${theme.statName}`;
            needsHeader.className = `p-5 text-center font-bold ${theme.needsColor}`;
        }

        async function loadData(league) {
            const tbody = document.getElementById('stats-body');
            const loading = document.getElementById('loading');
            const statusMsg = document.getElementById('status-message');
            
            // UI Reset
            tbody.innerHTML = '';
            loading.classList.remove('hidden');
            statusMsg.innerText = "Fetching data...";
            statusMsg.className = "text-sm text-gray-500 mt-2";

            let players = [];

            try {
                // Fetch JSON
                const response = await fetch(DATA_FILES[league]);
                if (!response.ok) throw new Error("File not found");
                
                players = await response.json();
                
                // Success Timestamp
                const now = new Date();
                statusMsg.innerText = `Updated: ${now.toLocaleTimeString()}`;
                statusMsg.className = "text-sm text-green-500 mt-2 font-mono";

            } catch (error) {
                console.warn("Fetch failed, loading mock data.", error);
                players = MOCK_DATA[league];
                statusMsg.innerHTML = `<span class="text-red-500">Offline Mode (Demo Data)</span>`;
            }

            loading.classList.add('hidden');

            if (!players || players.length === 0) {
                tbody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-gray-600 italic">No milestones in sight right now.</td></tr>`;
                return;
            }

            // Render Rows
            const theme = THEMES[league];
            
            players.forEach(player => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-gray-800 transition-colors border-b border-gray-800 last:border-0";
                
                // Urgency Calculation
                let urgencyClass = "text-gray-400";
                // Tighter threshold for NHL (goals) vs NBA (points)
                const urgentThreshold = league === 'nhl' ? 3 : 50; 
                const warningThreshold = league === 'nhl' ? 8 : 150;

                if (player.needed <= urgentThreshold) urgencyClass = "text-red-400 font-extrabold animate-pulse";
                else if (player.needed <= warningThreshold) urgencyClass = theme.needsColor + " font-bold";

                tr.innerHTML = `
                    <td class="p-5 font-bold text-white text-lg">${player.player_name}</td>
                    <td class="p-5 text-gray-500 font-mono text-sm">${player.team}</td>
                    <td class="p-5 text-center font-mono text-gray-300">${player.current_stat.toLocaleString()}</td>
                    <td class="p-5 text-center font-mono font-bold ${theme.color}">${player.target_milestone.toLocaleString()}</td>
                    <td class="p-5 text-center text-2xl ${urgencyClass}">${player.needed}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Initialize with NBA
        switchLeague('nba');

    </script>
</body>
</html>